!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("lodash")):"function"==typeof define&&define.amd?define(["exports","lodash"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self).DeclarationTools={},e.lodash)}(this,(function(e,n){"use strict";var t,r;e.Type=void 0,(t=e.Type||(e.Type={})).number="number",t.string="string",t.boolean="boolean",t.null="null",t[void 0]="undefined",t.object="object",t.array="array",t.any="any",function(e){e[e.Id1=0]="Id1",e[e.Id2=1]="Id2",e[e.Id3=2]="Id3",e[e.Id4=3]="Id4"}(r||(r={}));const y=n=>{let t=e.Type.any;const r=typeof n;return"number"===r?t=e.Type.number:"string"===r?t=e.Type.string:"boolean"===r?t=e.Type.boolean:"undefined"===r?t=e.Type.undefined:"object"===r&&(t=null===n?e.Type.null:Array.isArray(n)?e.Type.array:e.Type.object),t},o="schema";var d;e.SchemaErrorType=void 0,(d=e.SchemaErrorType||(e.SchemaErrorType={})).key="key",d.type="type",d[void 0]="undefined";const p=(t,o,d,c)=>{const a=y(t),i=`${d}.${a}`;if(n.has(o,d)||c(o,d,r.Id1),n.has(o,i)||c(o,i,r.Id2),a===e.Type.array){let d=[],a=[],s=!1;for(let r=0;r<t.length;r+=1)if(p(t[r],o,i,c),y(t[r])===e.Type.object)if(s){const e=Object.keys(t[r]);a=n.intersection(a,e),d=n.concat(d,n.difference(d,e))}else a=Object.keys(t[r]),d=a,s=!0;const f=n.uniq(n.difference(d,a));for(let n=0;n<f.length;n+=1)c(o,`${i}.${e.Type.object}.${f[n]}.${e.Type.undefined}`,r.Id3)}else if(a===e.Type.object){const e=Object.keys(t);for(let n=0;n<e.length;n+=1)p(t[e[n]],o,`${i}.${e[n]}`,c)}return o},c=(t,o,d,p)=>{const a=y(t),i=`${d}.${a}`,s=n.get(o,d);if(a!==e.Type.undefined||s[e.Type.undefined]){if(a===e.Type.array&&s[e.Type.array])for(let e=0;e<t.length;e+=1)c(t[e],o,i,p);else if(a===e.Type.object&&s[e.Type.object]){const n=Object.keys(s[e.Type.object]);for(let e=0;e<n.length;e+=1)c(t[n[e]],o,`${i}.${n[e]}`,p)}}else p(o,d,r.Id4)},a=(t,y,o,d,p)=>{p===r.Id1?(d.push(o),t.push({key:o,type:e.SchemaErrorType.key})):p===r.Id2?d.find((e=>0===o.indexOf(e)))||t.push({key:o,type:e.SchemaErrorType.type}):p===r.Id3?n.has(y,o)||d.find((e=>0===o.indexOf(e)))||t.push({key:o,type:e.SchemaErrorType.type}):p===r.Id4&&(t.find((e=>0===e.key.indexOf(o)))||t.push({key:o,type:e.SchemaErrorType.undefined}))},i=e=>{const t={schema:{}};return p(e,t,o,((e,t,r)=>{((e,t,r)=>{n.set(e,t,{})})(e,t)})),t},s=(e,n)=>{const t=[],r=[];return p(n,e,o,((e,n,y)=>{a(t,e,n,r,y)})),c(n,e,o,((e,n,y)=>{a(t,e,n,r,y)})),t};var f={Type:e.Type,identifyType:y,SchemaErrorType:e.SchemaErrorType,makeSchema:i,checkSchema:s};e.checkSchema=s,e.default=f,e.identifyType=y,e.makeSchema=i,Object.defineProperty(e,"__esModule",{value:!0})}));
